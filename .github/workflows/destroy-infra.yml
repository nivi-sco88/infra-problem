name: Destroy Infra
on:
    workflow_dispatch:
  
env:
        TW-CLIENT-ID: ${{ secrets.AZURE_CLIENT_ID }}
        TW-CLIENT-SECRET: ${{ secrets.AZURE_CLIENT_SECRET }}
        TW-SUBSCRIPTION-ID: ${{ secrets.AZURE_SUBSCRIPTION_ID }}
        TW-TENANT-ID: ${{ secrets.AZURE_TENANT_ID }}
  
jobs:

    Destroy_Azure_Infra:
        runs-on: ubuntu-latest

        steps:

            - name: Checkout code
              uses: actions/checkout@v2

            - name: Azure login
              uses: azure/login@v1
              with:
                creds: ${{ secrets.AZURE_CREDENTIALS }}

      # Initialize a new or existing Terraform working directory by creating initial files, loading any remote state, downloading modules, etc.
            - name: Terraform Destroy
              run: |
                cd terraform
                terraform init
                terraform remote config
                terraform destroy